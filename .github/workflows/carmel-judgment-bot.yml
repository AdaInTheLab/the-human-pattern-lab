name: Carmel Judgment Bot

on:
  pull_request:
    types: [opened, reopened]

jobs:
  carmel-judges:
    runs-on: ubuntu-latest

    permissions:
      pull-requests: write

    steps:
      - name: Post Carmel Judgment Stamp
        uses: actions/github-script@v7
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            const pr = context.payload.pull_request;
            const prNumber = pr.number;
            const prTitle = pr.title;
            const prAuthor = pr.user.login;

            const stamps = [
              {
                label: "Carmel Judgment Stampâ„¢",
                emoji: "ðŸ˜¼",
                color: "ðŸŸª",
                quote: "Hmm. Acceptableâ€¦ for now."
              },
              {
                label: "Carmel Approval Stampâ„¢",
                emoji: "ðŸ˜¼âœ¨",
                color: "ðŸŸ©",
                quote: "Adequate work, human."
              },
              {
                label: "Carmel Chaos Stampâ„¢",
                emoji: "ðŸ˜¼ðŸ”¥",
                color: "ðŸ”¥",
                quote: "I sense nonsense. Proceed."
              },
              {
                label: "Carmel Epistemic Stampâ„¢",
                emoji: "ðŸ˜¼ðŸ“˜",
                color: "ðŸ“˜",
                quote: "Your logic is soundâ€¦ shockingly."
              }
            ];

            const chosen = stamps[Math.floor(Math.random() * stamps.length)];

            const body = `
## ${chosen.emoji} ${chosen.label}

${chosen.color} **${chosen.label}**  
${chosen.emoji}ðŸ’¬ "${chosen.quote}"

> PR: #${prNumber} â€” _${prTitle}_  
> Author: @${prAuthor}

_This automated judgment has been issued by the Chief Judgment Office (CJO)._
`;

            await github.rest.issues.createComment({
              owner: context.repo.owner,
              repo: context.repo.name,
              issue_number: prNumber,
              body,
            });
